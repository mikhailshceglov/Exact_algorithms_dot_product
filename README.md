# Лабораторная работа №2: Скалярное произведение с компенсированными алгоритмами

Репозиторий содержит реализацию и сравнение разных алгоритмов вычисления скалярного произведения двух векторов с компенсацией ошибок округления.

## Структура проекта

```plaintext
lab2/                   Корень проекта
├── CMakeLists.txt      Главный конфиг для сборки (CMake)
├── README.md           Этот файл
├── docs/               Дополнительная документация
│   └── ТЗ №2.pdf       Условие лабораторной работы
├── include/            Заголовочные файлы
│   ├── kobbelt.hpp
│   ├── long_accumulator.hpp
│   ├── pichat.hpp
│   └── sorting.hpp
├── src/                Исходники реализаций
│   ├── main.cpp        Точка входа — сравнение алгоритмов
│   ├── kobbelt.cpp     Алгоритм Kobbelt
│   ├── long_accumulator.cpp  Double-double аккумулятор
│   ├── pichat.cpp      Алгоритм Pichat
│   └── sorting.cpp     Сортировка по экспонентам
├── tests/              Тестовый код
│   └── tests.cpp       Юнит‑тесты с использованием GMP
└── build/              Out‑of‑source сборка (игнорируется)
```

## Требования

- C++17
- CMake ≥ 3.10
- Библиотека GMP (libgmp-dev)
- Компилятор GCC или Clang

## Сборка и запуск проекта

### Сборка проекта
Осуществляется с помощью CMake:

```bash
cd lab2
cmake -S . -B build
cmake --build build
```

### Запуск основной программы

Выполняется исполняемый файл `main`, который выводит результаты всех алгоритмов на конкретных данных:

```bash
./build/main
```

### Запуск тестов

Тесты сравнивают точность каждого алгоритма с результатами, вычисленными через GMP (512 бит), и проверяют инвариантность к перестановкам.

```bash
./build/dot_product_tests
```

## Описание алгоритмов

- FMA — аккумулирование суммы через одну инструкцию fused‑multiply‑add
- Kobbelt — группировка произведений по экспоненте и аккумулирование в корзинах
- Long Accumulator — double-double аккумулятор на основе алгоритма Кэхэна
- Pichat — последовательное усреднение остатков сверху вниз
- Sorting — сортировка произведений по экспоненте перед суммированием

## Сравнение алгоритмов

| Алгоритм             | Точность                    | Память        | Инвариантность | Сложность   |
|----------------------|-----------------------------|---------------|----------------|-------------|
| FMA	               | Очень выскоая	             | O(1)          | ✅ Да          | O(n)        |
| Kobbelt              | Идеальная (битовая)         | O(n)          | ✅ Да          | O(n)        |
| Long Accumulator     | Идеальная (double-double)   | O(1)          | ✅ Да          | O(n)        |
| Pichat               | Средняя                     | O(n)          | ❌ Нет         | O(n²)       |
| Sorting              | Идеальная (после сортировки)| O(n)          | ✅ Да          | O(n log n)  |

## Тестирование

В tests/tests.cpp реализовано:
- Точное значение через GMP (512 бит)
- Побитовое сравнение результатов (в т.ч. NaN, ±∞)
- Проверка инвариантности при перестановке векторов

