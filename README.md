# Лабораторная работа №2: Скалярное произведение с компенсированными алгоритмами

Репозиторий содержит реализацию и сравнение разных алгоритмов вычисления скалярного произведения двух векторов с компенсацией ошибок округления.

## Структура проекта
lab2/                   Корень проекта
├── CMakeLists.txt      Главный конфиг для сборки (CMake)
├── README.md           Этот файл
├── docs/               Дополнительная документация
│   └── ТЗ №2.pdf       Условие лабораторной работы
├── include/            Заголовочные файлы
│   ├── kobbelt.hpp
│   ├── long_accumulator.hpp
│   ├── pichat.hpp
│   └── sorting.hpp
├── src/                Исходники реализаций
│   ├── main.cpp        Точка входа — сравнение алгоритмов
│   ├── kobbelt.cpp     Алгоритм Kobbelt
│   ├── long_accumulator.cpp  Double‑double аккумулятор
│   ├── pichat.cpp      Алгоритм Pichat
│   └── sorting.cpp     Сортировка по экспонентам
├── tests/              Тестовый код
│   └── tests.cpp       Юнит‑тесты с использованием GMP
└── build/              Out‑of‑source сборка (игнорируется)

## Требования

- C++17
- CMake ≥ 3.10
- Библиотека GMP (libgmp-dev)
- Компилятор GCC или Clang

## Сборка

cd lab2
cmake -S . -B build
cmake --build build

## Запуск

# Основная программа:
./build/main

# Тесты:
cd build
ctest --output-on-failure

# или:
cmake --build build --target run_tests

## Описание алгоритмов

- Kobbelt — группировка произведений по экспоненте и аккумулирование в корзинах
- Long Accumulator — double-double аккумулятор на основе алгоритма Кэхэна
- Pichat — последовательное усреднение остатков сверху вниз
- Sorting — сортировка произведений по экспоненте перед суммированием

## Сравнение алгоритмов

| Алгоритм             | Точность                    | Память        | Инвариантность | Сложность   |
|----------------------|-----------------------------|---------------|----------------|-------------|
| Kobbelt              | Идеальная (битовая)         | O(n)          | ✅ Да          | O(n)        |
| Long Accumulator     | Идеальная (double-double)   | O(1)          | ✅ Да          | O(n)        |
| Pichat               | Средняя                     | O(n)          | ❌ Нет         | O(n²)       |
| Sorting              | Идеальная (после сортировки)| O(n)          | ✅ Да          | O(n log n)  |

## Тестирование

В tests/tests.cpp реализовано:
- Точное значение через GMP (512 бит)
- Побитовое сравнение результатов (в т.ч. NaN, ±∞)
- Проверка инвариантности при перестановке векторов

### Кейсы

1. Простое скалярное произведение
2. Компенсация больших чисел
3. Разные порядки величин
4. Денормализованные числа
5. NaN и бесконечности

## Источники

1. Обзор алгоритмов точного суммирования
2. Алгоритмы Кэхэна, Пишара, Коббельта
3. Документация GNU MP (GMP)
